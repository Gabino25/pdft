package xxqp.oracle.apps.ar.pdft.ss.server;

import java.sql.SQLException;
import java.sql.Timestamp;

import oracle.apps.fnd.framework.OAException;
import oracle.apps.fnd.framework.OAFwkConstants;
import oracle.apps.fnd.framework.server.OAApplicationModuleImpl;
import oracle.apps.fnd.framework.server.OADBTransaction;
import oracle.apps.fnd.framework.webui.OAPageContext;
import oracle.apps.fnd.framework.webui.OAWebBeanConstants;
import oracle.apps.fnd.framework.webui.beans.layout.OASubTabLayoutBean;

import oracle.jbo.Row;
import oracle.jbo.RowSetIterator;




// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class SsAMImpl extends OAApplicationModuleImpl {
    /**This is the default constructor (do not remove)
     */
    public SsAMImpl() {
    }

    /**Sample main for debugging Business Components code using the tester.
     */
    public static void main(String[] args) {
        launchTester("xxqp.oracle.apps.ar.pdft.ss.server", /* package name */
      "SsAMLocal" /* Configuration Name */);
    }

    /**Container's getter for EjecutivosVO1
     */
    public EjecutivosVOImpl getEjecutivosVO1() {
        return (EjecutivosVOImpl)findViewObject("EjecutivosVO1");
    }

    /**Container's getter for FichasTecnicasVO1
     */
    public FichasTecnicasVOImpl getFichasTecnicasVO1() {
        return (FichasTecnicasVOImpl)findViewObject("FichasTecnicasVO1");
    }

    public void initFichasTecnicasVO(String pStrNoFichaTecnicaValue
                                    ,String pStrStatusValue
                                    ,java.sql.Timestamp pSqlTimestampFechaInicialOperacionValue
                                    ,java.sql.Timestamp pSqlTimestampFechaCreacionValue
                                    ,String pStrFvUserIdValue
                                    ,String pStrNombreDelClienteValue
                                    ,String pStrUnidadDeNegocio
                                    ,String pStrEmpresaQueFactura
                                    ,String pStrCicloFacturacion
                                    ) {
        oracle.jbo.domain.Number numNoFichaTecnica = null;
       oracle.jbo.domain.Date fechaInicialOperacion = null; 
       oracle.jbo.domain.Date fechaCreacion = null; 
       oracle.jbo.domain.Number numUserId = null; 
       
       
        try {
            if(null!=pStrNoFichaTecnicaValue)
            numNoFichaTecnica = new oracle.jbo.domain.Number(pStrNoFichaTecnicaValue);
            if(null!=pStrFvUserIdValue)
                numUserId = new oracle.jbo.domain.Number(pStrFvUserIdValue); 
        } catch (SQLException sqle) {
           throw new OAException("SQLException metodo initFichasTecnicasVO parametro pStrNoFichaTecnicaValue:"+sqle.getMessage(),OAException.ERROR); 
        }
        
        if(null!=pSqlTimestampFechaInicialOperacionValue){
        fechaInicialOperacion = new oracle.jbo.domain.Date(pSqlTimestampFechaInicialOperacionValue);
        }
        if(null!=pSqlTimestampFechaCreacionValue){
        fechaCreacion = new oracle.jbo.domain.Date(pSqlTimestampFechaCreacionValue);
        }
        
        FichasTecnicasVOImpl fichasTecnicasVOImpl = this.getFichasTecnicasVO1(); 
        if(null!=fichasTecnicasVOImpl){
            fichasTecnicasVOImpl.initByFilters(numNoFichaTecnica
                                              ,pStrStatusValue
                                              ,fechaInicialOperacion
                                              ,fechaCreacion
                                              ,numUserId
                                              ,pStrNombreDelClienteValue
                                              ,pStrUnidadDeNegocio
                                              ,pStrEmpresaQueFactura
                                              ,pStrCicloFacturacion
                                              ); 
        }  /** END if(null!=fichasTecnicasVOImpl){ **/
    }   

    public void consultaFichaTecnica(OAPageContext pageContext) {
        FichasTecnicasVOImpl fichasTecnicasVOImpl = getFichasTecnicasVO1();
        FichasTecnicasVORowImpl fichasTecnicasVORowImpl = null; 
        int countIsSelected = 0;
        if(null!=fichasTecnicasVOImpl){
        if(0==fichasTecnicasVOImpl.getFetchedRowCount()){
         return;
        }
          RowSetIterator iteratorFichasTecnicas =  fichasTecnicasVOImpl.createRowSetIterator(null);
          while(iteratorFichasTecnicas.hasNext()){
              fichasTecnicasVORowImpl = (FichasTecnicasVORowImpl)iteratorFichasTecnicas.next();
              if("Y".equals(fichasTecnicasVORowImpl.getIsSelected())){
                  countIsSelected = countIsSelected+1;
                  this.getOADBTransaction().writeDiagnostics(this,"fichasTecnicasVORowImpl.getOrigin():"+fichasTecnicasVORowImpl.getOrigin(),OAFwkConstants.STATEMENT);
               if("MYP".equals(fichasTecnicasVORowImpl.getOrigin())){
                   com.sun.java.util.collections.HashMap parameters = new com.sun.java.util.collections.HashMap();
                   parameters.put("pMyPHeaderId",fichasTecnicasVORowImpl.getId().toString() );
                   parameters.put("pMyPExtern","Y" );
                   pageContext.setForwardURL("OA.jsp?page=/xxqp/oracle/apps/ar/pdft/altafitec/masiplat/webui/MasivoYPlatinumReOnPG&"+OASubTabLayoutBean.OA_SELECTED_SUBTAB_IDX+"=0" /*url*/
                                             ,null /*functionName*/
                                             ,OAWebBeanConstants.KEEP_MENU_CONTEXT /*menuContextAction*/
                                             ,null /*menuName*/
                                             ,parameters /*parameters*/
                                             ,false /*retainAM*/
                                             ,OAWebBeanConstants.ADD_BREAD_CRUMB_NO /*addBreadCrumb*/
                                             ,OAException.ERROR /*messagingLevel*/
                                             );     
               }else if("BPO".equals(fichasTecnicasVORowImpl.getOrigin())){
                   com.sun.java.util.collections.HashMap parameters = new com.sun.java.util.collections.HashMap();
                   parameters.put("pBpoHeaderId",fichasTecnicasVORowImpl.getId().toString() );
                   parameters.put("pBpoExtern","Y" );
                   pageContext.setForwardURL("OA.jsp?page=/xxqp/oracle/apps/ar/pdft/altafitec/bpo/webui/BpoReOnPG&"+OASubTabLayoutBean.OA_SELECTED_SUBTAB_IDX+"=0" /*url*/
                                             ,null /*functionName*/
                                             ,OAWebBeanConstants.KEEP_MENU_CONTEXT /*menuContextAction*/
                                             ,null /*menuName*/
                                             ,parameters /*parameters*/
                                             ,false /*retainAM*/
                                             ,OAWebBeanConstants.ADD_BREAD_CRUMB_NO /*addBreadCrumb*/
                                             ,OAException.ERROR /*messagingLevel*/
                                             );     
               }else if("QP_LABS".equals(fichasTecnicasVORowImpl.getOrigin())){
                   com.sun.java.util.collections.HashMap parameters = new com.sun.java.util.collections.HashMap();
                   parameters.put("pQplabsHeaderId",fichasTecnicasVORowImpl.getId().toString() );
                   parameters.put("pQplabsExtern","Y" );
                   pageContext.setForwardURL("OA.jsp?page=/xxqp/oracle/apps/ar/pdft/altafitec/qplabs/webui/QpLabsReOnPG" /*url*/
                                             ,null /*functionName*/
                                             ,OAWebBeanConstants.KEEP_MENU_CONTEXT /*menuContextAction*/
                                             ,null /*menuName*/
                                             ,parameters /*parameters*/
                                             ,false /*retainAM*/
                                             ,OAWebBeanConstants.ADD_BREAD_CRUMB_NO /*addBreadCrumb*/
                                             ,OAException.ERROR /*messagingLevel*/
                                             );     
               }
              } /** END  if("Y".equals(fichasTecnicasVORowImpl.getIsSelected())){ **/
          } /** END while(fichasTecnicasVOImpl.hasNext()){ **/
          if(0==countIsSelected){
          throw new OAException("Seleccionar al menos una linea.",OAException.ERROR); 
          }
        } /** END if(null!=fichasTecnicasVOImpl){ **/
        
    }

    /**Container's getter for XxqpPdftUsuariosRoVO1
     */
    public XxqpPdftUsuariosRoVOImpl getXxqpPdftUsuariosRoVO1() {
        return (XxqpPdftUsuariosRoVOImpl)findViewObject("XxqpPdftUsuariosRoVO1");
    }

    public void createUserRecord() {
        XxqpPdftUsuariosRoVOImpl  xxqpPdftUsuariosRoVOImpl = getXxqpPdftUsuariosRoVO1();
        XxqpPdftUsuariosRoVORowImpl  xxqpPdftUsuariosRoVORowImpl = null;
        if(!xxqpPdftUsuariosRoVOImpl.isPreparedForExecution()){
            xxqpPdftUsuariosRoVOImpl.executeQuery();
        }
        xxqpPdftUsuariosRoVOImpl.first();
        xxqpPdftUsuariosRoVOImpl.previous();
        xxqpPdftUsuariosRoVORowImpl = (XxqpPdftUsuariosRoVORowImpl)xxqpPdftUsuariosRoVOImpl.createRow();
        xxqpPdftUsuariosRoVOImpl.insertRow(xxqpPdftUsuariosRoVORowImpl);
        xxqpPdftUsuariosRoVORowImpl.setNewRowState(Row.STATUS_NEW);
    }

    public void saveUserRecord() {
    OADBTransaction   oADBTransaction =  this.getOADBTransaction();
        XxqpPdftUsuariosRoVOImpl  xxqpPdftUsuariosRoVOImpl = getXxqpPdftUsuariosRoVO1();
        RowSetIterator iterator = xxqpPdftUsuariosRoVOImpl.createRowSetIterator("");
        while(iterator.hasNext()){
            XxqpPdftUsuariosRoVORowImpl  xxqpPdftUsuariosRoVORowImpl = null;
            xxqpPdftUsuariosRoVORowImpl = (XxqpPdftUsuariosRoVORowImpl)iterator.next();
            if(null==xxqpPdftUsuariosRoVORowImpl.getId()||"".equals(xxqpPdftUsuariosRoVORowImpl.getId())){
                oracle.jbo.domain.Number numUsuariosID =   oADBTransaction.getSequenceValue("XXQP_PDFT_USUARIOS_RO_S");
                xxqpPdftUsuariosRoVORowImpl.setId(numUsuariosID);
            }
        }
        oADBTransaction.commit();
        xxqpPdftUsuariosRoVOImpl.executeQuery();
    }

    public String validaUsuarioPassword(String strUsuario, 
                                      String strConstrasenia, 
                                      OAPageContext pageContext) {
        String retval = "Usuario y/o Password Invalidos."; 
        XxqpPdftUsuariosRoVOImpl  xxqpPdftUsuariosRoVOImpl = getXxqpPdftUsuariosRoVO1();
        xxqpPdftUsuariosRoVOImpl.initByUserPassword(strUsuario
                                                   ,strConstrasenia
                                                   );
        RowSetIterator UsuarioIterator = xxqpPdftUsuariosRoVOImpl.createRowSetIterator(null); 
        if(UsuarioIterator.hasNext()){
            UsuarioIterator.next();
            retval = null; 
        }
        UsuarioIterator.closeRowSetIterator();
        return retval;
    }
}
